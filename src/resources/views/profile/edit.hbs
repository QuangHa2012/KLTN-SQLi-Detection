<div class="container py-5">
  <div class="mx-auto" style="max-width: 700px;">
    <h2 class="fw-semibold mb-4 text-center">Chỉnh sửa thông tin</h2>

    <form action="/profile/edit" method="POST" class="bg-white p-4 border">
      <div class="mb-3">
        <label class="form-label fw-semibold">Tên người dùng</label>
        <input type="text" name="username" value="{{user.username}}" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Email</label>
        <input type="email" name="email" value="{{user.email}}" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Số điện thoại</label>
        <input type="text" name="phone" value="{{user.phone}}" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Địa chỉ</label>
        <input type="text" name="address" value="{{user.address}}" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label d-block mb-2">Giới tính</label>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="male"
            value="male"
            {{#if (eq user.gender "male")}}checked{{/if}}
          />
          <label class="form-check-label" for="male">Nam</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="female"
            value="female"
            {{#if (eq user.gender "female")}}checked{{/if}}
          />
          <label class="form-check-label" for="female">Nữ</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="other"
            value="other"
            {{#if (eq user.gender "other")}}checked{{/if}}
          />
          <label class="form-check-label" for="other">Khác</label>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">Ngày sinh</label>
        <div class="d-flex gap-2 flex-wrap justify-content-space-around">
          <select id="day" name="day" class="form-select border border-secondary mr-3" required></select>
          <select id="month" name="month" class="form-select border border-secondary mr-3" required></select>
          <select id="year" name="year" class="form-select border border-secondary" required></select>
        </div>
      </div>

      <div class="d-flex justify-content-between mt-4">
        <a href="/profile" class="btn btn-outline-secondary px-4 profile-btn">← Quay lại</a>
        <button type="submit" class="btn btn-dark px-4 profile-btn">Lưu thay đổi</button>
      </div>
    </form>
  </div>
</div>

<style>
  .form-select {
    border-radius: 6px !important;
    padding: 8px;
    min-width: 120px;
  }

  label.form-label {
    font-weight: 600;
  }

  @media (max-width: 576px) {
    .form-select {
      width: 100%;
    }
  }
</style>
<script>
  // Lấy ngày sinh từ user nếu có
  const birthday = "{{user.birthday}}" ? new Date("{{user.birthday}}") : null;

  const daySelect = document.getElementById("day");
  const monthSelect = document.getElementById("month");
  const yearSelect = document.getElementById("year");

  // Ngày
  for (let d = 1; d <= 31; d++) {
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = d;
    if (birthday && d === birthday.getDate()) opt.selected = true;
    daySelect.appendChild(opt);
  }

  // Tháng
  const months = [
    "Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6",
    "Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"
  ];
  months.forEach((m, i) => {
    const opt = document.createElement("option");
    opt.value = i + 1;
    opt.textContent = m;
    if (birthday && i === birthday.getMonth()) opt.selected = true;
    monthSelect.appendChild(opt);
  });

  // Năm (1900 → năm hiện tại)
  const currentYear = new Date().getFullYear();
  for (let y = currentYear; y >= 1900; y--) {
    const opt = document.createElement("option");
    opt.value = y;
    opt.textContent = y;
    if (birthday && y === birthday.getFullYear()) opt.selected = true;
    yearSelect.appendChild(opt);
  }
</script>
