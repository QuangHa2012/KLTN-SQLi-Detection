<div class="container py-5">
  <div class="mx-auto profile-edit-card p-4">
    <h2 class="fw-semibold mb-4 text-center profile-edit-title">Chỉnh sửa thông tin</h2>
    {{#if error}}
      <div class="alert alert-danger text-center">{{error}}</div>
    {{/if}}
    <form action="/profile/edit" method="POST" class="bg-white p-4 border rounded-3 profile-edit-form">
      <div class="mb-3">
        <label class="form-label fw-semibold">Tên người dùng</label>
        <input type="text" name="username" value="{{user.username}}" class="form-control rounded-2" required>
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Email</label>
        <input type="email" name="email" value="{{user.email}}" class="form-control rounded-2"
        {{#unless (eq user.authProvider "local")}}disabled{{/unless}}>
        {{#unless (eq user.authProvider "local")}}
          <div class="form-text text-warning">
            Email chỉ có thể thay đổi nếu bạn đăng ký bằng tài khoản thường.
          </div>
        {{/unless}}
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Số điện thoại</label>
        <input type="text" name="phone" value="{{user.phone}}" class="form-control rounded-2">
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Địa chỉ</label>
        <input type="text" name="address" value="{{user.address}}" class="form-control rounded-2">
      </div>

      <div class="mb-3">
        <label class="form-label d-block mb-2">Giới tính</label>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="male"
            value="male"
            {{#if (eq user.gender "male")}}checked{{/if}}
          />
          <label class="form-check-label" for="male">Nam</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="female"
            value="female"
            {{#if (eq user.gender "female")}}checked{{/if}}
          />
          <label class="form-check-label" for="female">Nữ</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="gender"
            id="other"
            value="other"
            {{#if (eq user.gender "other")}}checked{{/if}}
          />
          <label class="form-check-label" for="other">Khác</label>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Ngày sinh</label>
        <div class="d-flex gap-2 flex-wrap birthday-selects">
          <select id="day" name="day" class="form-select rounded-2 mr-3" required></select>
          <select id="month" name="month" class="form-select rounded-2 mr-3" required></select>
          <select id="year" name="year" class="form-select rounded-2" required></select>
        </div>
      </div>

      <div class="d-flex justify-content-between mt-4">
        <a href="/profile" class="btn btn-outline-secondary px-4 profile-btn">← Quay lại</a>
        <button type="submit" class="btn btn-dark px-4 profile-btn">Lưu thay đổi</button>
      </div>
    </form>
  </div>
</div>

<style>
.profile-edit-card {
  max-width: 700px;
  background: #fdfdfd;
  border-radius: 20px;
  border: 1px solid #eee;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}

.profile-edit-title {
  background: #cccfd1;
  padding: 12px 0;
  border-radius: 12px;
  border: 1px solid #e0e0e0;
  font-weight: 600;
}

.profile-edit-form input,
.profile-edit-form select {
  border-radius: 8px;
  border: 1px solid #ced4da;
}

.profile-edit-form input:focus,
.profile-edit-form select:focus {
  border-color: #495057;
  box-shadow: 0 0 0 0.15rem rgba(0,0,0,0.05);
}

.birthday-selects .form-select {
  min-width: 100px;
}

@media (max-width: 576px) {
  .birthday-selects .form-select {
    min-width: 100%;
  }
}
</style>
<script>
  // Lấy ngày sinh từ user nếu có
  const birthday = "{{user.birthday}}" ? new Date("{{user.birthday}}") : null;

  const daySelect = document.getElementById("day");
  const monthSelect = document.getElementById("month");
  const yearSelect = document.getElementById("year");

  // Ngày
  for (let d = 1; d <= 31; d++) {
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = d;
    if (birthday && d === birthday.getDate()) opt.selected = true;
    daySelect.appendChild(opt);
  }

  // Tháng
  const months = [
    "Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6",
    "Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"
  ];
  months.forEach((m, i) => {
    const opt = document.createElement("option");
    opt.value = i + 1;
    opt.textContent = m;
    if (birthday && i === birthday.getMonth()) opt.selected = true;
    monthSelect.appendChild(opt);
  });

  // Năm (1900 → năm hiện tại)
  const currentYear = new Date().getFullYear();
  for (let y = currentYear; y >= 1900; y--) {
    const opt = document.createElement("option");
    opt.value = y;
    opt.textContent = y;
    if (birthday && y === birthday.getFullYear()) opt.selected = true;
    yearSelect.appendChild(opt);
  }
</script>
