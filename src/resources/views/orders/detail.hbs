<div class="container mt-5 order-detail">
  <h2 class="mb-4">Chi tiết đơn hàng #{{order.id}}</h2>

  <!-- Thông tin đơn hàng -->
  <div class="card p-3 mb-4">
    <p><strong>Ngày tạo:</strong> {{formatDate order.createdAt}}</p>
    <p><strong>Tổng tiền:</strong> {{formatPrice order.total}}</p>
    <p><strong>Trạng thái:</strong>
      {{#if (eq order.status "paid")}}
        <span class="badge badge-success">Đã thanh toán</span>
      {{else if (eq order.status "pending")}}
        <span class="badge badge-warning">Chưa thanh toán</span>
      {{else if (eq order.status "failed")}}
        <span class="badge badge-danger">Thanh toán thất bại</span>
      {{else if (eq order.status "shipping")}}
        <span class="badge badge-info">Đang giao</span>
      {{else if (eq order.status "completed")}}
        <span class="badge badge-primary">Hoàn tất</span>
      {{else}}
        <span class="badge badge-secondary">Đã hủy</span>
      {{/if}}
    </p>
  </div>

  <!-- Hành động -->
  {{#if (or (eq order.status "pending") (eq order.status "failed"))}}
    <form action="/orders/{{order.id}}/retry" method="POST" class="mb-3">
      <button type="submit" class="btn btn-warning">Thanh toán lại</button>
    </form>
    <form action="/orders/{{order.id}}/cancel" method="POST" class="mt-3 mb-3">
      <button type="submit" class="btn btn-danger">Hủy đơn hàng</button>
    </form>
  {{/if}}

  <h4>Sản phẩm</h4>

  <!-- TABLE DESKTOP / TABLET -->
  <div class="table-responsive d-none d-md-block">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Ảnh</th>
          <th>Tên</th>
          <th>Số lượng</th>
          <th>Giá</th>
          <th>Tổng</th>
        </tr>
      </thead>
      <tbody>
        {{#each items}}
        <tr>
          <td><img src="{{this.img}}" alt="{{this.name}}" style="width:60px"></td>
          <td>{{this.name}}</td>
          <td>{{this.quantity}}</td>
          <td>{{formatPrice this.price}}</td>
          <td>{{formatPrice (multiply this.price this.quantity)}}</td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>

  <!-- MOBILE CARD -->
  <div class="d-block d-md-none">
    {{#each items}}
    <div class="product-card">
      <div class="product-row">
        <img src="{{this.img}}" alt="{{this.name}}">
        <div class="product-info">
          <p><strong>{{this.name}}</strong></p>
          <p>Số lượng: {{this.quantity}}</p>
          <p>Giá: {{formatPrice this.price}}</p>
          <p>Tổng: {{formatPrice (multiply this.price this.quantity)}}</p>
        </div>
      </div>
    </div>
    {{/each}}
  </div>

  <div class="mt-3">
    <a href="/orders" class="btn btn-secondary">Quay lại danh sách</a>
  </div>
</div>

<style>
/* ===== CONTAINER ===== */
.container.order-detail {
  background: #fff;
  border-radius: 10px;
  padding: 30px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  font-family: "Segoe UI", Roboto, sans-serif;
  color: #333;
  margin-top: 40px;
}

/* Tiêu đề */
.order-detail h2 {
  text-align: center;
  font-weight: 600;
  color: #222;
  margin-bottom: 25px;
}

.order-detail h4 {
  font-weight: 600;
  margin-top: 35px;
  margin-bottom: 15px;
  color: #333;
}

/* Thẻ thông tin đơn */
.order-detail .card {
  background-color: #f9fafb;
  border-radius: 8px;
  border: 1px solid #e0e0e0;
}

.order-detail .card p {
  margin-bottom: 8px;
  font-size: 15px;
}

/* Badge trạng thái */
.badge {
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 13px;
}

.badge-success {background-color: #28a745 !important;}
.badge-warning {background-color: #ffc107 !important; color:#222;}
.badge-danger {background-color: #dc3545 !important;}
.badge-info {background-color: #17a2b8 !important;}
.badge-primary {background-color: #007bff !important;}
.badge-secondary {background-color: #6c757d !important;}

/* Bảng sản phẩm */
.order-detail .table {
  border-radius: 8px;
  overflow: hidden;
  background-color: #fff;
}

.order-detail .table th {
  background-color: #f8f9fa;
  font-weight: 600;
  color: #333;
  text-align: center;
  vertical-align: middle;
}

.order-detail .table td {
  text-align: center;
  vertical-align: middle;
  font-size: 15px;
}

/* Nút */
.order-detail .btn {
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 15px;
  transition: all 0.2s ease;
}

.order-detail .btn-warning {
  background-color: #ffc107;
  border: none;
  color: #222;
}

.order-detail .btn-warning:hover {
  background-color: #e0a800;
}

.order-detail .btn-danger {
  background-color: #dc3545;
  border: none;
}

.order-detail .btn-danger:hover {
  background-color: #c82333;
}

.order-detail .btn-secondary {
  background-color: #6c757d;
  border: none;
}

.order-detail .btn-secondary:hover {
  background-color: #141618;
}

/* Khoảng cách nút */
.order-detail form {
  display: inline-block;
  margin-right: 10px;
}

/* ===== MOBILE PRODUCT CARD ===== */
@media (max-width: 767px) {
  .product-card {
    background: #fff;
    border-radius: 12px;
    padding: 12px;
    margin-bottom: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }

  .product-row {
    display: flex;
    gap: 12px;
  }

  .product-row img {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    object-fit: cover;
  }

  .product-info p {
    margin: 4px 0;
    font-size: 14px;
  }
}
</style>
